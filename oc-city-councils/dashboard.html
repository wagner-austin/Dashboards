<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=1024, viewport-fit=cover, user-scalable=yes">
    <title>OC City Councils</title>
    <style>
        :root {
            --primary: #0066a1;
            --primary-dark: #004d7a;
            --primary-light: #e8f4fc;
            --accent: #4da6d9;
            --accent-light: #d9eef8;
            --success: #16a34a;
            --success-light: #dcfce7;
            --warning: #ca8a04;
            --warning-light: #fef3c7;
            --danger: #dc2626;
            --danger-light: #fee2e2;
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-600: #4b5563;
            --gray-700: #374151;
            --gray-800: #1f2937;
            --gray-900: #111827;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            font-size: 1rem;
            line-height: 1.6;
            color: var(--gray-800);
            background: linear-gradient(135deg, #e8f4fc 0%, #f0f7fc 50%, #e0f0f8 100%);
            min-height: 100vh;
        }
        .header-container {
            position: sticky;
            top: 0;
            z-index: 100;
            background: white;
        }
        .header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: 1.5rem 2rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .header h1 { font-size: 1.5rem; }
        .header .subtitle { font-size: 0.9rem; opacity: 0.9; margin-top: 0.25rem; }
        .select-bar {
            background: var(--gray-100);
            padding: 0.75rem 2rem;
            border-bottom: 1px solid var(--gray-200);
        }
        .select-bar select {
            font-size: 0.95rem;
            padding: 0.5rem 1rem;
            border: 2px solid var(--primary);
            border-radius: 6px;
            background: white;
            cursor: pointer;
            min-width: 220px;
            font-weight: 500;
            color: var(--gray-800);
        }
        .select-bar select:focus { outline: 2px solid var(--accent); outline-offset: 1px; }
        .content {
            padding: 2rem;
            background: rgba(255, 255, 255, 0.5);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            min-height: calc(100vh - 100px);
        }
        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }
        .card {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 1.25rem;
            border: 1px solid rgba(255, 255, 255, 0.3);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .card:hover { transform: translateY(-2px); box-shadow: 0 8px 24px rgba(0,102,161,0.15); }
        .card h4 { font-size: 0.7rem; text-transform: uppercase; letter-spacing: 0.05em; color: var(--gray-600); margin-bottom: 0.25rem; }
        .card .value { font-size: 2rem; font-weight: 700; color: var(--gray-900); }
        .card .subtext { font-size: 0.75rem; color: var(--gray-600); }
        h2 { font-size: 1.25rem; margin-bottom: 1rem; color: var(--gray-800); border-bottom: 3px solid var(--accent); padding-bottom: 0.5rem; display: inline-block; }
        h3 { font-size: 1rem; margin: 1.5rem 0 0.75rem; color: var(--gray-700); }
        .section { margin-bottom: 2rem; }
        .links-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1rem; margin: 1.5rem 0; }
        .link-card {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.4);
            border-radius: 12px;
            padding: 1.25rem;
            text-decoration: none;
            color: var(--gray-800);
            transition: all 0.2s;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        .link-card:hover { border-color: var(--primary); box-shadow: 0 8px 24px rgba(0,102,161,0.2); transform: translateY(-3px); }
        .link-card h4 { color: var(--primary); margin-bottom: 0.5rem; font-size: 1rem; }
        .link-card p { font-size: 0.85rem; margin: 0; color: var(--gray-600); }
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
        }
        .info-card {
            background: rgba(255, 255, 255, 0.75);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.4);
            border-radius: 12px;
            padding: 1.25rem;
        }
        .info-card h4 { font-size: 0.7rem; text-transform: uppercase; letter-spacing: 0.05em; color: var(--gray-600); margin-bottom: 0.75rem; }
        .info-row { display: flex; justify-content: space-between; padding: 0.4rem 0; font-size: 0.9rem; border-bottom: 1px solid var(--gray-100); }
        .info-row:last-child { border-bottom: none; }
        .info-row dt { color: var(--gray-600); }
        .info-row dd { color: var(--gray-900); font-weight: 500; }
        .info-row dd a { color: var(--primary); text-decoration: none; }
        .info-row dd a:hover { text-decoration: underline; }
        .council-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 1.25rem; }
        .council-card {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.4);
            border-radius: 12px;
            padding: 1.25rem;
            text-align: center;
            transition: all 0.2s;
            text-decoration: none;
            display: block;
            color: inherit;
        }
        .council-card:hover { border-color: var(--primary); box-shadow: 0 8px 24px rgba(0,102,161,0.15); cursor: pointer; }
        .council-card .photo {
            width: 140px;
            height: 175px;
            object-fit: cover;
            object-position: top;
            margin: 0 auto 1rem;
            display: block;
            border-radius: 8px;
            background: var(--gray-200);
        }
        .council-card .name { font-weight: 700; color: var(--gray-900); margin-bottom: 0.25rem; font-size: 1.1rem; }
        .council-card .position { font-size: 0.9rem; color: var(--primary); font-weight: 500; }
        .council-card .district { font-size: 0.8rem; color: var(--gray-600); margin-top: 0.25rem; }
        .council-card .contact-info { font-size: 0.75rem; color: var(--gray-600); margin-top: 0.75rem; }
        .hidden { display: none; }
    </style>
</head>
<body>
    <div class="header-container">
        <div class="header">
            <h1>OC City Councils</h1>
            <div class="subtitle" id="subtitle">Orange County, California</div>
        </div>
        <div class="select-bar">
            <select id="citySelect"></select>
        </div>
    </div>

    <div class="content">
        <div id="mainContent" class="hidden">
            <div class="section">
                <h2>Quick Links</h2>
                <div class="links-grid" id="links"></div>
            </div>

            <div class="section">
                <h2>Information</h2>
                <div class="info-grid">
                    <div class="info-card">
                        <h4>Meetings</h4>
                        <dl id="meetingInfo"></dl>
                    </div>
                    <div class="info-card">
                        <h4>City Clerk</h4>
                        <dl id="clerkInfo"></dl>
                    </div>
                    <div class="info-card">
                        <h4>Public Comment</h4>
                        <dl id="commentInfo"></dl>
                    </div>
                    <div class="info-card">
                        <h4>Elections</h4>
                        <dl id="electionInfo"></dl>
                    </div>
                </div>
            </div>

            <div class="section">
                <h2>Council Members</h2>
                <div class="council-grid" id="members"></div>
            </div>
        </div>
    </div>

    <script>
        let cities = [];

        async function init() {
            const res = await fetch('dashboard_data.json');
            cities = await res.json();
            const select = document.getElementById('citySelect');

            cities.forEach((c, i) => {
                const opt = document.createElement('option');
                opt.value = i;
                opt.textContent = c.city_name;
                select.appendChild(opt);
            });
            select.addEventListener('change', () => showCity(select.value));
            if (cities.length) showCity(0);
        }

        function linkCard(url, title, desc) {
            return url ? `<a href="${url}" target="_blank" class="link-card"><h4>${title}</h4><p>${desc}</p></a>` : '';
        }

        function row(label, value) {
            return value ? `<div class="info-row"><dt>${label}</dt><dd>${value}</dd></div>` : '';
        }

        function showCity(idx) {
            document.getElementById('mainContent').classList.remove('hidden');
            const c = cities[idx];

            document.getElementById('subtitle').textContent = c.city_name + ', California';

            // Links - deduplicate
            const urls = new Set();
            const links = [];
            const addLink = (url, title, desc) => {
                if (url && !urls.has(url)) {
                    urls.add(url);
                    links.push(linkCard(url, title, desc));
                }
            };
            addLink(c.website, 'City Website', 'Official city homepage');
            addLink(c.council_url, 'Council Page', 'Council member information and contact');
            addLink(c.portals?.agendas, 'Agendas & Minutes', 'View meeting agendas and minutes');
            addLink(c.portals?.live_stream || c.broadcast?.live_stream, 'Watch Meetings', 'Live stream and meeting videos');
            addLink(c.portals?.granicus, 'Video Archive', 'Past meeting recordings');
            addLink(c.portals?.ecomment, 'eComment', 'Submit public comment online');
            document.getElementById('links').innerHTML = links.join('');

            // Meetings
            const m = c.meetings || {};
            const loc = m.location || {};
            const fullAddr = [loc.name, loc.address, loc.city_state_zip].filter(Boolean).join(', ');
            const mapsUrl = fullAddr ? `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(fullAddr)}` : '';
            document.getElementById('meetingInfo').innerHTML =
                row('Schedule', m.schedule) +
                row('Time', m.time) +
                row('Location', loc.name) +
                row('Address', loc.address ? (mapsUrl ? `<a href="${mapsUrl}" target="_blank">${loc.address}</a>` : loc.address) : '');

            // Clerk
            const cl = c.clerk || {};
            document.getElementById('clerkInfo').innerHTML =
                row('Phone', cl.phone ? `<a href="tel:${cl.phone.replace(/[^0-9+]/g, '')}">${cl.phone}</a>` : '') +
                row('Email', cl.email ? `<a href="mailto:${cl.email}">${cl.email}</a>` : '');

            // Public Comment
            const pc = c.public_comment || {};
            document.getElementById('commentInfo').innerHTML =
                row('Email', pc.email ? `<a href="mailto:${pc.email}">${pc.email}</a>` : '') +
                row('Deadline', pc.deadline) +
                row('In Person', pc.in_person ? 'Yes' : pc.in_person === false ? 'No' : '') +
                row('Remote', pc.remote_live ? 'Yes' : pc.remote_live === false ? 'No' : '');

            // Elections
            const el = c.elections || {};
            document.getElementById('electionInfo').innerHTML =
                row('Next Election', el.next_election) +
                row('Seats Up', el.seats_up?.length ? el.seats_up.join(', ') : '');

            // Council Members
            document.getElementById('members').innerHTML = (c.members || []).map(mem => {
                const profileUrl = mem.city_page || c.council_url || '#';
                return `
                <a class="council-card" href="${profileUrl}" target="_blank">
                    ${mem.photo_url ? `<img class="photo" src="${mem.photo_url}" alt="${mem.name}" loading="lazy" onerror="this.style.visibility='hidden'">` : '<div class="photo"></div>'}
                    <div class="name">${mem.name}</div>
                    <div class="position">${mem.position}</div>
                    ${mem.district ? `<div class="district">${mem.district}</div>` : ''}
                    <div class="contact-info">
                        ${mem.email ? `<span>${mem.email}</span>` : ''}
                        ${mem.phone ? `<br><span>${mem.phone}</span>` : ''}
                    </div>
                </a>
            `}).join('');
        }

        init();
    </script>
</body>
</html>
